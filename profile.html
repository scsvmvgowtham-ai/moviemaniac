<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>My Profile | MovieManiac</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <!-- ================= NAVBAR ================= -->
  <header class="navbar">
    <div class="logo">ğŸ¬ MovieManiac</div>
    <nav class="nav-bar">
      <a href="home.html">Home</a>
      <a href="index.html">Movies</a>
      <a href="actors.html">Actors</a>
      <a href="actresses.html">Actresses</a>
      <a href="comedians.html">Comedians</a>
      <a href="directors.html">Directors</a>
      <a href="watchlist.html">Watchlist</a>
      <a href="game.html">Game</a>
      <div id="authNav"></div>
    </nav>
  </header>

  <!-- ================= PROFILE CONTENT ================= -->
  <main class="profile-container">
    <div class="profile-card">
      <h1>ğŸ‘¤ My Profile</h1>
      
      <div class="profile-info">
        <div class="profile-avatar">
          <span id="profileCharacter" style="font-size: 5rem;"></span>
        </div>
        
        <div class="profile-details">
          <h2 id="profileUsername"></h2>
          <p id="profileEmail"></p>
          <p id="profileMember"></p>
        </div>
      </div>

      <div class="profile-stats">
        <div class="stat-box">
          <span class="stat-number" id="watchlistCount">0</span>
          <span class="stat-label">Movies in Watchlist</span>
        </div>
        <div class="stat-box">
          <span class="stat-number" id="gameScore">0</span>
          <span class="stat-label">Best Game Score</span>
        </div>
      </div>

      <div class="profile-actions">
        <a href="watchlist.html" class="btn-primary">View Watchlist</a>
        <a href="game.html" class="btn-primary">Play Game</a>
        <button class="btn-secondary" onclick="handleLogout()">Logout</button>
      </div>

      <div class="profile-edit">
        <h3>Change Character</h3>
        <select id="newCharacter">
          <option value="">Select new character...</option>
          <optgroup label="Iconic Characters">
            <option value="ğŸ¦¸ Iron Man">ğŸ¦¸ Iron Man</option>
            <option value="ğŸ¦‡ Batman">ğŸ¦‡ Batman</option>
            <option value="ğŸ•·ï¸ Spider-Man">ğŸ•·ï¸ Spider-Man</option>
            <option value="âš¡ Thor">âš¡ Thor</option>
            <option value="ğŸ›¡ï¸ Captain America">ğŸ›¡ï¸ Captain America</option>
            <option value="ğŸ’š Hulk">ğŸ’š Hulk</option>
            <option value="ğŸ± Black Panther">ğŸ± Black Panther</option>
            <option value="âš”ï¸ Wonder Woman">âš”ï¸ Wonder Woman</option>
            <option value="ğŸ¦… Superman">ğŸ¦… Superman</option>
            <option value="ğŸ”¥ Phoenix">ğŸ”¥ Phoenix</option>
          </optgroup>
          <optgroup label="Legendary Heroes">
            <option value="ğŸ—¡ï¸ Aragorn">ğŸ—¡ï¸ Aragorn</option>
            <option value="ğŸ§™ Gandalf">ğŸ§™ Gandalf</option>
            <option value="âš¡ Harry Potter">âš¡ Harry Potter</option>
            <option value="ğŸ¦ Simba">ğŸ¦ Simba</option>
            <option value="ğŸŒŠ Moana">ğŸŒŠ Moana</option>
            <option value="â„ï¸ Elsa">â„ï¸ Elsa</option>
            <option value="ğŸ¹ Katniss">ğŸ¹ Katniss</option>
            <option value="ğŸ¯ Hawkeye">ğŸ¯ Hawkeye</option>
            <option value="ğŸŒŸ Luke Skywalker">ğŸŒŸ Luke Skywalker</option>
            <option value="âš”ï¸ Rey">âš”ï¸ Rey</option>
          </optgroup>
          <optgroup label="Action Stars">
            <option value="ğŸ”« James Bond">ğŸ”« James Bond</option>
            <option value="ğŸ•¶ï¸ Neo">ğŸ•¶ï¸ Neo</option>
            <option value="ğŸ¤– Terminator">ğŸ¤– Terminator</option>
            <option value="ğŸš— Fast & Furious">ğŸš— Fast & Furious</option>
            <option value="ğŸ’ Jack Sparrow">ğŸ’ Jack Sparrow</option>
            <option value="ğŸ­ Joker">ğŸ­ Joker</option>
            <option value="ğŸ‘‘ T'Challa">ğŸ‘‘ T'Challa</option>
            <option value="ğŸª Deadpool">ğŸª Deadpool</option>
          </optgroup>
          <optgroup label="Classic Icons">
            <option value="ğŸ¬ Godfather">ğŸ¬ Godfather</option>
            <option value="ğŸ‘” Tony Soprano">ğŸ‘” Tony Soprano</option>
            <option value="ğŸŒ¹ Rose (Titanic)">ğŸŒ¹ Rose (Titanic)</option>
            <option value="ğŸ’ Frodo">ğŸ’ Frodo</option>
            <option value="ğŸ¯ Sherlock">ğŸ¯ Sherlock</option>
          </optgroup>
        </select>
        <button class="btn-primary" onclick="updateCharacter()">Update Character</button>
      </div>
    </div>
  </main>

  <!-- ================= FOOTER ================= -->
  <footer>
    <p>Â© 2026 MovieManiac - Your Cinematic Journey Begins Here</p>
  </footer>

  <!-- ================= SCRIPTS ================= -->
  <script src="js/data.js"></script>
  <script src="js/auth.js"></script>
  <script src="js/navigation.js"></script>
  <script>
    // Check if logged in
    const user = window.MovieManiacAuth.getCurrentUser();
    if (!user) {
      window.location.href = 'signin.html';
    }

    // Load profile data
    document.getElementById('profileCharacter').textContent = user.favoriteCharacter.split(' ')[0];
    document.getElementById('profileUsername').textContent = user.username;
    document.getElementById('profileEmail').textContent = user.email;
    
    const joinDate = new Date(user.createdAt).toLocaleDateString();
    document.getElementById('profileMember').textContent = `Member since ${joinDate}`;

    // Load watchlist count
    const watchlist = localStorage.getItem('moviemaniac_watchlist');
    const count = watchlist ? JSON.parse(watchlist).length : 0;
    document.getElementById('watchlistCount').textContent = count;

    // Load best game score
    const scores = localStorage.getItem('moviemaniac_game_scores');
    if (scores) {
      const scoresObj = JSON.parse(scores);
      const allScores = [
        ...Object.values(scoresObj.easy || {}),
        ...Object.values(scoresObj.medium || {}),
        ...Object.values(scoresObj.hard || {})
      ].filter(s => s > 0);
      const bestScore = allScores.length > 0 ? Math.max(...allScores) : 0;
      document.getElementById('gameScore').textContent = bestScore;
    }

    function handleLogout() {
      if (confirm('Are you sure you want to logout?')) {
        window.MovieManiacAuth.logout();
        window.location.href = 'home.html';
      }
    }

    function updateCharacter() {
      const newChar = document.getElementById('newCharacter').value;
      if (!newChar) {
        alert('Please select a character');
        return;
      }

      const result = window.MovieManiacAuth.updateProfile({ favoriteCharacter: newChar });
      if (result.success) {
        alert(result.message);
        location.reload();
      } else {
        alert(result.message);
      }
    }
  </script>
</body>
</html>
